-- ============================================
-- Katorin2 Seed Data
-- Local development dummy data
-- ============================================

-- ダミーユーザーを auth.users に作成
INSERT INTO auth.users (id, email, encrypted_password, email_confirmed_at, created_at, updated_at, instance_id, aud, role)
VALUES
  ('11111111-1111-1111-1111-111111111111', 'tanaka@example.com', crypt('password123', gen_salt('bf')), NOW(), NOW(), NOW(), '00000000-0000-0000-0000-000000000000', 'authenticated', 'authenticated'),
  ('22222222-2222-2222-2222-222222222222', 'yamada@example.com', crypt('password123', gen_salt('bf')), NOW(), NOW(), NOW(), '00000000-0000-0000-0000-000000000000', 'authenticated', 'authenticated'),
  ('33333333-3333-3333-3333-333333333333', 'suzuki@example.com', crypt('password123', gen_salt('bf')), NOW(), NOW(), NOW(), '00000000-0000-0000-0000-000000000000', 'authenticated', 'authenticated'),
  ('44444444-4444-4444-4444-444444444444', 'sato@example.com', crypt('password123', gen_salt('bf')), NOW(), NOW(), NOW(), '00000000-0000-0000-0000-000000000000', 'authenticated', 'authenticated'),
  ('55555555-5555-5555-5555-555555555555', 'kobayashi@example.com', crypt('password123', gen_salt('bf')), NOW(), NOW(), NOW(), '00000000-0000-0000-0000-000000000000', 'authenticated', 'authenticated'),
  ('66666666-6666-6666-6666-666666666666', 'watanabe@example.com', crypt('password123', gen_salt('bf')), NOW(), NOW(), NOW(), '00000000-0000-0000-0000-000000000000', 'authenticated', 'authenticated'),
  ('77777777-7777-7777-7777-777777777777', 'takahashi@example.com', crypt('password123', gen_salt('bf')), NOW(), NOW(), NOW(), '00000000-0000-0000-0000-000000000000', 'authenticated', 'authenticated'),
  ('88888888-8888-8888-8888-888888888888', 'ito@example.com', crypt('password123', gen_salt('bf')), NOW(), NOW(), NOW(), '00000000-0000-0000-0000-000000000000', 'authenticated', 'authenticated')
ON CONFLICT (id) DO NOTHING;

-- プロフィールを作成
INSERT INTO profiles (id, display_name, master_duel_id, discord_id, bio)
VALUES
  ('11111111-1111-1111-1111-111111111111', '田中太郎', '123-456-789', 'tanaka#1234', 'マスターデュエル歴2年。青眼使いです！'),
  ('22222222-2222-2222-2222-222222222222', '山田花子', '234-567-890', 'yamada#5678', 'コントロールデッキが好きです'),
  ('33333333-3333-3333-3333-333333333333', '鈴木一郎', '345-678-901', 'suzuki#9012', '烙印使い。大会優勝目指してます'),
  ('44444444-4444-4444-4444-444444444444', '佐藤健', '456-789-012', 'sato#3456', 'ティアラメンツ全盛期から始めました'),
  ('55555555-5555-5555-5555-555555555555', '小林美咲', '567-890-123', 'kobayashi#7890', 'かわいいデッキが好き'),
  ('66666666-6666-6666-6666-666666666666', '渡辺翔', '678-901-234', 'watanabe#2345', 'メタビート専門'),
  ('77777777-7777-7777-7777-777777777777', '高橋恵', '789-012-345', 'takahashi#6789', 'エクソシスター推し'),
  ('88888888-8888-8888-8888-888888888888', '伊藤誠', '890-123-456', 'ito#0123', '純構築が信条')
ON CONFLICT (id) DO NOTHING;

-- 大会を作成
INSERT INTO tournaments (id, title, description, organizer_id, visibility, status, tournament_format, match_format, max_participants, entry_start_at, entry_deadline, start_at, current_round, custom_fields)
VALUES
  -- 進行中の大会（8人トーナメント）
  ('aaaa0001-0001-0001-0001-000000000001',
   '第1回 Katorinカップ',
   '記念すべき第1回大会です！初心者から上級者まで参加歓迎！',
   '11111111-1111-1111-1111-111111111111',
   'public', 'in_progress', 'single_elimination', 'bo3', 8,
   NOW() - INTERVAL '7 days', NOW() - INTERVAL '1 day', NOW() - INTERVAL '1 hour',
   1,
   '[{"key": "deck_name", "label": "使用デッキ名", "required": true, "placeholder": "例: 青眼"}]'::jsonb),

  -- 募集中の大会
  ('aaaa0002-0002-0002-0002-000000000002',
   '週末トーナメント #1',
   '毎週開催予定のカジュアル大会です。気軽にご参加ください！',
   '22222222-2222-2222-2222-222222222222',
   'public', 'recruiting', 'single_elimination', 'bo3', 16,
   NOW() - INTERVAL '1 day', NOW() + INTERVAL '3 days', NOW() + INTERVAL '5 days',
   0,
   '[{"key": "deck_name", "label": "使用デッキ名", "required": true, "placeholder": "例: 烙印"}]'::jsonb),

  -- 下書きの大会
  ('aaaa0003-0003-0003-0003-000000000003',
   '上級者限定大会（仮）',
   'ダイヤ1以上限定の大会を企画中',
   '11111111-1111-1111-1111-111111111111',
   'public', 'draft', 'single_elimination', 'bo3', 32,
   NULL, NULL, NULL,
   0,
   '[]'::jsonb)
ON CONFLICT (id) DO NOTHING;

-- 進行中大会の参加者（8人）
INSERT INTO participants (id, tournament_id, user_id, entry_number, seed, display_name, custom_data)
VALUES
  ('bbbb0001-0001-0001-0001-000000000001', 'aaaa0001-0001-0001-0001-000000000001', '11111111-1111-1111-1111-111111111111', 1, 1, '田中太郎', '{"deck_name": "青眼"}'),
  ('bbbb0002-0002-0002-0002-000000000002', 'aaaa0001-0001-0001-0001-000000000001', '22222222-2222-2222-2222-222222222222', 2, 2, '山田花子', '{"deck_name": "ラビュリンス"}'),
  ('bbbb0003-0003-0003-0003-000000000003', 'aaaa0001-0001-0001-0001-000000000001', '33333333-3333-3333-3333-333333333333', 3, 3, '鈴木一郎', '{"deck_name": "烙印"}'),
  ('bbbb0004-0004-0004-0004-000000000004', 'aaaa0001-0001-0001-0001-000000000001', '44444444-4444-4444-4444-444444444444', 4, 4, '佐藤健', '{"deck_name": "スネークアイ"}'),
  ('bbbb0005-0005-0005-0005-000000000005', 'aaaa0001-0001-0001-0001-000000000001', '55555555-5555-5555-5555-555555555555', 5, 5, '小林美咲', '{"deck_name": "マドルチェ"}'),
  ('bbbb0006-0006-0006-0006-000000000006', 'aaaa0001-0001-0001-0001-000000000001', '66666666-6666-6666-6666-666666666666', 6, 6, '渡辺翔', '{"deck_name": "メタビート"}'),
  ('bbbb0007-0007-0007-0007-000000000007', 'aaaa0001-0001-0001-0001-000000000001', '77777777-7777-7777-7777-777777777777', 7, 7, '高橋恵', '{"deck_name": "エクソシスター"}'),
  ('bbbb0008-0008-0008-0008-000000000008', 'aaaa0001-0001-0001-0001-000000000001', '88888888-8888-8888-8888-888888888888', 8, 8, '伊藤誠', '{"deck_name": "閃刀姫"}')
ON CONFLICT (id) DO NOTHING;

-- 募集中大会の参加者（4人エントリー済み）
INSERT INTO participants (id, tournament_id, user_id, entry_number, display_name, custom_data)
VALUES
  ('bbbb0011-0011-0011-0011-000000000011', 'aaaa0002-0002-0002-0002-000000000002', '33333333-3333-3333-3333-333333333333', 1, '鈴木一郎', '{"deck_name": "烙印ビーステッド"}'),
  ('bbbb0012-0012-0012-0012-000000000012', 'aaaa0002-0002-0002-0002-000000000002', '44444444-4444-4444-4444-444444444444', 2, '佐藤健', '{"deck_name": "R-ACE"}'),
  ('bbbb0013-0013-0013-0013-000000000013', 'aaaa0002-0002-0002-0002-000000000002', '55555555-5555-5555-5555-555555555555', 3, '小林美咲', '{"deck_name": "ふわんだりぃず"}'),
  ('bbbb0014-0014-0014-0014-000000000014', 'aaaa0002-0002-0002-0002-000000000002', '66666666-6666-6666-6666-666666666666', 4, '渡辺翔', '{"deck_name": "神碑"}')
ON CONFLICT (id) DO NOTHING;

-- 8人シングルエリミネーションのトーナメント表

-- 決勝戦 (Round 3)
INSERT INTO matches (id, tournament_id, round, match_number, status)
VALUES ('cccc0007-0007-0007-0007-000000000007', 'aaaa0001-0001-0001-0001-000000000001', 3, 1, 'pending')
ON CONFLICT (id) DO NOTHING;

-- 準決勝 (Round 2)
INSERT INTO matches (id, tournament_id, round, match_number, player1_id, player2_id, status, next_match_id, next_match_slot)
VALUES
  ('cccc0005-0005-0005-0005-000000000005', 'aaaa0001-0001-0001-0001-000000000001', 2, 1,
   '11111111-1111-1111-1111-111111111111', '33333333-3333-3333-3333-333333333333',
   'in_progress', 'cccc0007-0007-0007-0007-000000000007', 1),
  ('cccc0006-0006-0006-0006-000000000006', 'aaaa0001-0001-0001-0001-000000000001', 2, 2,
   '55555555-5555-5555-5555-555555555555', '88888888-8888-8888-8888-888888888888',
   'pending', 'cccc0007-0007-0007-0007-000000000007', 2)
ON CONFLICT (id) DO NOTHING;

-- 1回戦 (Round 1) - 全て完了
INSERT INTO matches (id, tournament_id, round, match_number, player1_id, player2_id, player1_score, player2_score, winner_id, status, next_match_id, next_match_slot, completed_at)
VALUES
  ('cccc0001-0001-0001-0001-000000000001', 'aaaa0001-0001-0001-0001-000000000001', 1, 1,
   '11111111-1111-1111-1111-111111111111', '22222222-2222-2222-2222-222222222222',
   2, 1, '11111111-1111-1111-1111-111111111111', 'completed',
   'cccc0005-0005-0005-0005-000000000005', 1, NOW() - INTERVAL '30 minutes'),
  ('cccc0002-0002-0002-0002-000000000002', 'aaaa0001-0001-0001-0001-000000000001', 1, 2,
   '33333333-3333-3333-3333-333333333333', '44444444-4444-4444-4444-444444444444',
   2, 0, '33333333-3333-3333-3333-333333333333', 'completed',
   'cccc0005-0005-0005-0005-000000000005', 2, NOW() - INTERVAL '25 minutes'),
  ('cccc0003-0003-0003-0003-000000000003', 'aaaa0001-0001-0001-0001-000000000001', 1, 3,
   '55555555-5555-5555-5555-555555555555', '66666666-6666-6666-6666-666666666666',
   2, 1, '55555555-5555-5555-5555-555555555555', 'completed',
   'cccc0006-0006-0006-0006-000000000006', 1, NOW() - INTERVAL '20 minutes'),
  ('cccc0004-0004-0004-0004-000000000004', 'aaaa0001-0001-0001-0001-000000000001', 1, 4,
   '77777777-7777-7777-7777-777777777777', '88888888-8888-8888-8888-888888888888',
   0, 2, '88888888-8888-8888-8888-888888888888', 'completed',
   'cccc0006-0006-0006-0006-000000000006', 2, NOW() - INTERVAL '15 minutes')
ON CONFLICT (id) DO NOTHING;
