# 機能要件

## 概要

遊戯王マスターデュエルのオンライントーナメント運営システム。
[Tonamel](https://tonamel.com/) の機能を参考に、マスターデュエル向けに最適化。

## ユーザー種別

| 種別 | 説明 |
|------|------|
| 主催者 | 大会を作成・運営するユーザー |
| 参加者 | 大会にエントリーするユーザー |
| 管理者 | システム全体を管理（将来対応） |

---

## 機能一覧

### 1. 認証機能

| 機能 | 優先度 | 説明 |
|------|--------|------|
| メール認証 | 必須 | メールアドレス+パスワードでの登録・ログイン |
| Discord連携 | 任意 | DiscordアカウントでのOAuthログイン |
| プロフィール設定 | 必須 | 表示名、マスターデュエルID等の設定 |

### 2. 大会管理機能（主催者向け）

#### 2.1 大会作成

| 機能 | 優先度 | 説明 |
|------|--------|------|
| 基本情報設定 | 必須 | タイトル、説明、カバー画像、開催日時 |
| 公開設定 | 必須 | 公開 / 限定公開（URL知っている人のみ） / 非公開 |
| 参加者数上限 | 必須 | エントリー可能な最大人数 |
| エントリー期間 | 必須 | 受付開始〜締切日時 |

#### 2.2 トーナメント設定

| 機能 | 優先度 | 説明 |
|------|--------|------|
| 形式選択 | 必須 | シングルエリミ / ダブルエリミ / スイスドロー |
| 対戦形式 | 必須 | シングル戦（1本勝負） / マッチ戦（2本先取） |
| チェックイン | 必須 | 有効/無効を大会ごとに設定可能 |
| 結果報告方式 | 必須 | 主催者のみ / 参加者入力+承認 |

#### 2.3 エントリーフォーム

| 機能 | 優先度 | 説明 |
|------|--------|------|
| カスタム項目 | 必須 | 主催者が入力項目を追加可能 |
| デッキ登録 | 任意 | 大会設定で必須/任意/不要を選択 |

#### 2.4 進行管理

| 機能 | 優先度 | 説明 |
|------|--------|------|
| トーナメント表生成 | 必須 | 参加者からマッチング自動生成 |
| シード設定 | 必須 | 特定参加者の配置指定 |
| 結果入力 | 必須 | 各試合の勝敗入力・確定 |
| ラウンド進行 | 必須 | 次ラウンドへの自動進行 |

### 3. 参加者向け機能

| 機能 | 優先度 | 説明 |
|------|--------|------|
| 大会検索・一覧 | 必須 | 公開大会の閲覧 |
| エントリー | 必須 | 大会への参加申請 |
| チェックイン | 必須 | 大会開始前の参加確認（設定時） |
| 対戦相手確認 | 必須 | 現在の対戦相手・ステータス表示 |
| 結果報告 | 必須 | 試合結果の入力（設定時） |
| 結果承認 | 必須 | 相手の報告した結果の承認/異議 |

### 4. トーナメント表示

| 機能 | 優先度 | 説明 |
|------|--------|------|
| リアルタイム更新 | 必須 | 結果確定時に自動更新 |
| 進行状況表示 | 必須 | 待機中/対戦中/終了のステータス |
| 順位表示 | 必須 | 最終順位・ランキング |

### 5. 通知機能

| 機能 | 優先度 | 説明 |
|------|--------|------|
| アプリ内通知 | 必須 | 対戦開始、結果確定などの通知 |
| Discord通知 | 将来 | Webhook連携での通知 |

---

## 対応トーナメント形式

### シングルエリミネーション
- 1敗で敗退する勝ち抜き戦
- 最も一般的な形式
- 参加者数: 2のべき乗が理想（不足時はBye対応）

### ダブルエリミネーション
- 2敗で敗退
- 勝者側ブラケット・敗者側ブラケットの管理
- グランドファイナルのリセット対応

### スイスドロー
- 全員が規定回数対戦
- 勝ち点が近い者同士でマッチング
- タイブレーカー: オポネントマッチウィン率など

---

## 非機能要件

| 項目 | 要件 |
|------|------|
| レスポンシブ | PC・スマートフォン両対応 |
| リアルタイム性 | 結果更新は即時反映（Supabase Realtime） |
| 同時接続 | 〜200人程度を想定 |
| 可用性 | Vercel + Supabaseの標準SLA |

---

## MVP（最小実装範囲）

Phase 1でリリースする最小機能:

1. **認証**: メール認証のみ
2. **大会作成**: 基本情報 + シングルエリミのみ
3. **エントリー**: 基本フォームのみ
4. **進行管理**: トーナメント表生成 + 結果入力（主催者のみ）
5. **表示**: トーナメント表のリアルタイム更新

Phase 2以降:
- ダブルエリミ / スイスドロー対応
- 参加者による結果報告
- チェックイン機能
- Discord連携
- デッキ登録機能

---

## 参考

- [Tonamel](https://tonamel.com/) - 大会運営プラットフォーム
- [Tonamelの使い方初心者講座](https://embrabat-report.net/entry/how_to_use_Tonamel)
